<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13C-NMR Workbook Pro</title>
    <style>
        /* Dark Theme Base */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            line-height: 1.6; 
            padding: 20px; 
            background-color: #1c1c1e; 
            color: #f2f2f7; 
        }

        .container { 
            max-width: 1100px; 
            margin: auto; 
            background: #2c2c2e; 
            padding: 30px; 
            border-radius: 16px; 
            box-shadow: 0 8px 30px rgba(0,0,0,0.3); 
        }

        .header-section { text-align: center; margin-bottom: 30px; }
        h2 { font-weight: 700; letter-spacing: -0.5px; margin: 0; color: #ffffff; }
        .subtitle { font-size: 1.1rem; color: #aeaeb2; margin-top: 5px; font-style: italic; }

        .main-layout {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }

        .input-section, .output-section {
            flex: 1;
            min-width: 0;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        input, select, textarea { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid #48484a; 
            border-radius: 8px; 
            box-sizing: border-box; 
            font-size: 14px;
            background-color: #3a3a3c;
            color: #ffffff;
        }

        textarea { height: 180px; font-family: "SF Mono", monospace; }
        
        .controls { margin-top: 15px; display: flex; gap: 10px; }
        
        button { 
            border: none; 
            padding: 12px 20px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 15px; 
            font-weight: 600;
            transition: all 0.2s ease; 
        }
        
        .btn-process { background-color: #0a84ff; color: white; flex-grow: 2; }
        .btn-clear { background-color: #636366; color: white; flex-grow: 1; }
        .btn-copy { background-color: #30d158; color: white; margin-top: 15px; width: 100%; }
        
        .output-area { 
            margin-top: 10px; 
            padding: 20px; 
            background: #ffffff; 
            border-radius: 8px; 
            word-wrap: break-word; 
            border: 1px solid #d1d1d6; 
            font-family: "Times New Roman", Times, serif;
            font-size: 12pt; 
            color: #000000;
        }

        .carbon-count {
            display: block;
            margin-top: 2em;
            color: rgb(255, 0, 0); 
            font-weight: normal; 
            font-family: "Times New Roman", Times, serif;
            font-size: 12pt;
        }

        label { font-weight: 600; display: block; margin-top: 10px; margin-bottom: 5px; font-size: 11px; color: #aeaeb2; text-transform: uppercase; }

        .info-footer {
            margin-top: 40px;
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 30px;
            border-top: 1px solid #48484a;
            padding-top: 20px;
        }

        .guide-box, .reference-box {
            background: #3a3a3c;
            padding: 20px;
            border-radius: 12px;
            font-size: 13px;
        }

        .guide-box h3, .reference-box h3 { font-size: 16px; margin-top: 0; color: #0a84ff; border-bottom: 1px solid #48484a; padding-bottom: 8px; }

        .shift-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 11px;
        }
        .shift-table th, .shift-table td {
            text-align: left;
            padding: 4px;
            border-bottom: 1px solid #48484a;
        }
        .shift-table th { color: #0a84ff; }

        .flow-container { display: flex; flex-direction: column; align-items: center; margin: 15px 0; }
        .flow-step { background: #48484a; padding: 8px; border-radius: 6px; border: 1px solid #0a84ff; text-align: center; width: 90%; margin-bottom: 5px; }
        .flow-arrow { color: #0a84ff; font-weight: bold; margin-bottom: 5px; }

        @media (max-width: 900px) {
            .main-layout, .info-footer { flex-direction: column; grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header-section">
        <h2>13C-NMR Workbook</h2>
        <div class="subtitle">by Amit Jangra</div>
    </div>
    
    <div class="main-layout">
        <div class="input-section">
            <div class="settings-grid">
                <div>
                    <label>Frequency (MHz)</label>
                    <input type="number" id="freqInput" placeholder="e.g. 101" value="101">
                </div>
                <div>
                    <label>Solvent</label>
                    <select id="solventSelect">
                        <optgroup label="Common">
                            <option value="CDCl3">CDCl3</option>
                            <option value="DMSO-d6">DMSO-d6</option>
                            <option value="CD3OD">CD3OD</option>
                            <option value="D2O">D2O</option>
                            <option value="Acetone-d6">Acetone-d6</option>
                        </optgroup>
                        <optgroup label="Organic">
                            <option value="C6D6">C6D6</option>
                            <option value="CD2Cl2">CD2Cl2</option>
                            <option value="CD3CN">CD3CN</option>
                            <option value="THF-d8">THF-d8</option>
                            <option value="Toluene-d8">Toluene-d8</option>
                            <option value="Pyridine-d5">Pyridine-d5</option>
                            <option value="CCl4">CCl4</option>
                            <option value="CS2">CS2</option>
                            <option value="Nitromethane-d3">CD3NO2</option>
                            <option value="DMF-d7">DMF-d7</option>
                            <option value="1,4-Dioxane-d8">Dioxane-d8</option>
                        </optgroup>
                        <optgroup label="Halogenated/Other">
                            <option value="TFA-d">TFA-d</option>
                            <option value="Acetic Acid-d4">CD3COOD</option>
                            <option value="Chloroform-d1">CDCl3</option>
                            <option value="Nitrobenzene-d5">C6D5NO2</option>
                            <option value="o-Dichlorobenzene-d4">C6D4Cl2</option>
                            <option value="Chlorobenzene-d5">C6D5Cl</option>
                            <option value="Methanol-d4">CD3OD</option>
                        </optgroup>
                    </select>
                </div>
                <div>
                    <label>Journal Format</label>
                    <select id="journalSelect">
                        <option value="std">Standard (δc 150.1, 120.4)</option>
                        <option value="acs">ACS Style (δ 150.1, 120.4)</option>
                        <option value="rsc">RSC Style (δ/ppm 150.1, 120.4)</option>
                        <option value="nature">Nature (δ: 150.1, 120.4)</option>
                        <option value="wiley">Wiley (150.1, 120.4 ppm)</option>
                        <option value="elsevier">Elsevier (δ = 150.1, 120.4)</option>
                        <option value="thieme">Thieme (δ = 150.1, 120.4)</option>
                        <option value="mdpi">MDPI (δ 150.1, 120.4)</option>
                        <option value="springer">Springer (δ 150.1, 120.4)</option>
                        <option value="cell">Cell Press (δ 150.1, 120.4)</option>
                    </select>
                </div>
                <div>
                    <label>Decimal Places</label>
                    <select id="decimalSelect">
                        <option value="1">1 Decimal (125.1)</option>
                        <option value="2">2 Decimals (125.12)</option>
                    </select>
                </div>
            </div>

            <label for="inputData">Input 13C peak values</label>
            <textarea id="inputData" placeholder="Paste peak values (separated by spaces, commas, or enters)..."></textarea>
            
            <div class="controls">
                <button class="btn-process" onclick="processData()">Convert & Format</button>
                <button class="btn-clear" onclick="clearAll()">Clear All</button>
            </div>
        </div>

        <div class="output-section">
            <div id="resultWrapper" style="display:none;">
                <label>Publication Ready Text</label>
                <div id="output" class="output-area"></div>
                <button class="btn-copy" onclick="copyToClipboard()">Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <div class="info-footer">
        <div class="guide-box">
            <h3>Advanced Workflow</h3>
            <div class="flow-container">
                <div class="flow-step"><b>1. Prep:</b> Select solvent and specific Journal style.</div>
                <div class="flow-arrow">▼</div>
                <div class="flow-step"><b>2. Input:</b> Paste list from NMR software (TopSpin/MestReNova).</div>
                <div class="flow-arrow">▼</div>
                <div class="flow-step"><b>3. Clean:</b> System auto-sorts (Desc) and applies -0.01 shift correction.</div>
                <div class="flow-arrow">▼</div>
                <div class="flow-step"><b>4. Finalize:</b> Review Carbon Count and copy into manuscript.</div>
            </div>
            <p><i>Tip: Use 2 decimals for closely spaced aliphatic peaks or chiral environments.</i></p>
        </div>

        <div class="reference-box">
            <h3>13C Chemical Shift Reference (δ ppm)</h3>
            <table class="shift-table">
                <tr><th>Functional Group</th><th>Range (ppm)</th><th>Group</th><th>Range (ppm)</th></tr>
                <tr><td>Ketones (C=O)</td><td>200–220</td><td>Alkynes (sp)</td><td>65–90</td></tr>
                <tr><td>Aldehydes (CHO)</td><td>190–200</td><td>Alcohols (C-OH)</td><td>50–70</td></tr>
                <tr><td>Acids/Esters</td><td>160–185</td><td>Ethers (C-O-C)</td><td>60–80</td></tr>
                <tr><td>Amides (CONH2)</td><td>165–175</td><td>Amines (C-NH2)</td><td>35–55</td></tr>
                <tr><td>Aromatics (Ar-C)</td><td>110–160</td><td>Aliphatic (CH3)</td><td>5–25</td></tr>
                <tr><td>Alkenes (C=C)</td><td>100–150</td><td>Aliphatic (CH2)</td><td>20–45</td></tr>
                <tr><td>Nitriles (CN)</td><td>115–125</td><td>Aliphatic (CH)</td><td>30–60</td></tr>
                <tr><td>C-F (Aromatic)</td><td>150–165</td><td>C-Cl</td><td>35–50</td></tr>
                <tr><td>Quaternary C</td><td>30–50</td><td>TMS/Reference</td><td>0</td></tr>
            </table>
        </div>
    </div>
</div>

<script>
    function formatSolvent(solvent) {
        return solvent.replace(/(\d+)/g, '<sub>$1</sub>');
    }

    function processData() {
        const input = document.getElementById('inputData').value;
        const freq = document.getElementById('freqInput').value || "101";
        const solventRaw = document.getElementById('solventSelect').value;
        const journal = document.getElementById('journalSelect').value;
        const decimals = parseInt(document.getElementById('decimalSelect').value);
        
        const numbers = input.match(/-?\d+(\.\d+)?/g);
        if (!numbers) {
            alert("No peak values found. Please paste numerical data.");
            return;
        }

        let processedNumbers = numbers.map(numStr => {
            let val = parseFloat(numStr);
            let thresholdShift = val - 0.01;
            return Math.round(thresholdShift * Math.pow(10, decimals)) / Math.pow(10, decimals);
        });

        processedNumbers.sort((a, b) => b - a);
        const finalStrings = processedNumbers.map(n => n.toFixed(decimals));
        const solventFormatted = formatSolvent(solventRaw);

        let prefix = "";
        let suffix = "";
        let separator = ", ";
        let listEnd = ";";

        // Journal Style Logic
        switch(journal) {
            case 'acs': prefix = `<i>&delta;</i> `; break;
            case 'rsc': prefix = `<i>&delta;</i>/ppm `; break;
            case 'nature': prefix = `<i>&delta;</i>: `; break;
            case 'wiley': prefix = ``; suffix = ` ppm`; break;
            case 'elsevier': prefix = `<i>&delta;</i> = `; break;
            case 'thieme': prefix = `<i>&delta;</i> = `; break;
            case 'mdpi': prefix = `<i>&delta;</i> `; break;
            case 'springer': prefix = `<i>&delta;</i> `; break;
            case 'cell': prefix = `<i>&delta;</i> `; break;
            default: prefix = `<i>&delta;<sub>C</sub></i> `;
        }

        const formattedHtml = 
            `<sup>13</sup>C{<sup>1</sup>H} NMR (${freq} MHz, ${solventFormatted}): ${prefix}` + 
            finalStrings.join(separator) + suffix + listEnd +
            `<span class="carbon-count">Carbon count: ${finalStrings.length}</span>`;

        document.getElementById('output').innerHTML = formattedHtml;
        document.getElementById('resultWrapper').style.display = 'block';
    }

    function clearAll() {
        document.getElementById('inputData').value = '';
        document.getElementById('output').innerHTML = '';
        document.getElementById('resultWrapper').style.display = 'none';
    }

    function copyToClipboard() {
        const el = document.getElementById('output');
        const range = document.createRange();
        range.selectNode(el);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        try {
            document.execCommand('copy');
            alert("Copied to clipboard!");
        } catch (err) {
            alert("Unable to copy");
        }
        window.getSelection().removeAllRanges();
    }
</script>

</body>
</html>